<!-- https://www.d3-graph-gallery.com/graph/choropleth_basic.html -->
<!DOCTYPE html>
<meta charset="utf-8">
          
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v6.js"></script>
<script src = "http://d3js.org/topojson.v0.min.js"></script>

<!-- Create an element where the map will take place -->
<svg id="my_dataviz" width="400" height="300"></svg>
  <div id="content">
    <canvas width="800" height="400"></canvas>
  </div>
<style>
   path {
      stroke: white;
      stroke-width: 0.5px;
      fill: grey;
   }
   
   .stateTN { fill: red; }
   .stateAP { fill: blue; }
   .stateMP{ fill: green; }
</style>
<script>


//let projection = d3.geoMercator();
/*
let projection = d3.geoEquirectangular();

*/
/*
// The svg
const svg = d3.select("svg"),
  width = +svg.attr("width"),
  height = +svg.attr("height");


d3.json("https://kstoneburner.github.io/DSC640/wk09_10/counties-albers-10m.json")
.then(function(geojson){
let u = d3.select('#content g.map')
  .selectAll('path')
  .data(geojson.features)
  .join('path')
  .attr('d', geoGenerator);



});
  */

/*
let projection = d3.geoEquirectangular();

let geoGenerator = d3.geoPath()
  .projection(projection);

d3.json("https://kstoneburner.github.io/DSC640/wk09_10/counties-albers-10m.json")
.then(function(geojson){
let u = d3.select('#content g.map')
  .selectAll('path')
  .data(geojson.features)
  .join('path')
  .attr('d', geoGenerator);
});
*/

let geojson = {}

let context = d3.select('#content canvas')
  .node()
  .getContext('2d');

let projection = d3.geoEquirectangular()
  .scale(300);

let geoGenerator = d3.geoPath()
  .projection(projection)
  .pointRadius(4)
  .context(context);

let yaw = 300;

function update() {
  projection.rotate([yaw, -45])

  context.clearRect(0, 0, 800, 600);

  context.lineWidth = 0.5;
  context.strokeStyle = '#333';

  context.beginPath();
  //geoGenerator({type: 'FeatureCollection', features: geojson.features})
  //geoGenerator({type: 'Topology', features: geojson.objects.counties.geometries})
  geoGenerator(geojson);
  //context.stroke();

  // Graticule
  let graticule = d3.geoGraticule();
  context.beginPath();
  context.strokeStyle = '#ccc';
  geoGenerator(graticule());
  context.stroke();

  //yaw -= 0.2
}



// REQUEST DATA
d3.json("https://kstoneburner.github.io/DSC640/wk09_10/counties-albers-10m.json")

//d3.json('https://gist.githubusercontent.com/d3indepth/f28e1c3a99ea6d84986f35ac8646fac7/raw/c58cede8dab4673c91a3db702d50f7447b373d98/ne_110m_land.json')
  .then(function(json) {
  geojson = json;
  console.log(geojson)
  update();
  //window.setInterval(update, 100);
})

  



</script>